---
title: Flux å›¾åƒç”Ÿæˆ API
description: ä½¿ç”¨ Flux Kontext Pro/Max æ¨¡å‹ç”Ÿæˆé«˜è´¨é‡å›¾åƒï¼Œæ”¯æŒå¤šç§å®½é«˜æ¯”ï¼Œæ€§ä»·æ¯”è¶…è¶Šå®˜æ–¹å®šä»·
icon: "sparkles"
---

## Flux å›¾åƒç”Ÿæˆ API

Flux æ˜¯ä¸šç•Œé¢†å…ˆçš„å›¾åƒç”Ÿæˆæ¨¡å‹ï¼Œé€šè¿‡ è€å¼ API çš„ OpenAI å…¼å®¹æ¥å£ï¼Œæ‚¨å¯ä»¥è½»æ¾è°ƒç”¨ Flux Kontext Pro å’Œ Max æ¨¡å‹ç”Ÿæˆé«˜è´¨é‡å›¾åƒã€‚æˆ‘ä»¬æä¾›äº†æ¯”å®˜æ–¹æ›´ä¼˜æƒ çš„ä»·æ ¼ï¼Œç»“åˆæ±‡ç‡ä¼˜åŠ¿å’Œå……å€¼åŠ èµ ï¼Œä¸ºæ‚¨èŠ‚çœæ›´å¤šæˆæœ¬ã€‚

<Note>
**ğŸ¯ é«˜è´¨é‡ç”Ÿæˆ**  
Flux æ¨¡å‹ä»¥å…¶å‡ºè‰²çš„å›¾åƒè´¨é‡å’Œç»†èŠ‚è¡¨ç°è‘—ç§°ï¼Œæ”¯æŒä» 3:7 åˆ° 7:3 çš„çµæ´»å®½é«˜æ¯”è®¾ç½®ã€‚
</Note>

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

- **ğŸ“ çµæ´»æ¯”ä¾‹**ï¼šæ”¯æŒä» 3:7 åˆ° 7:3 çš„è¿ç»­å®½é«˜æ¯”èŒƒå›´
- **ğŸ¨ é«˜è´¨é‡è¾“å‡º**ï¼š1 å…†åƒç´ å›¾åƒï¼Œç»†èŠ‚ä¸°å¯Œï¼Œè‰ºæœ¯è¡¨ç°åŠ›å¼º
- **ğŸ’° ä»·æ ¼ä¼˜åŠ¿**ï¼šæ¯”å®˜æ–¹å®šä»·æ›´ä¼˜æƒ ï¼ŒèŠ‚çœæˆæœ¬
- **ğŸ”§ OpenAI å…¼å®¹**ï¼šä½¿ç”¨æ ‡å‡† Images API æ ¼å¼ï¼Œæ˜“äºé›†æˆ
- **â±ï¸ URL æœ‰æ•ˆæœŸ**ï¼šç”Ÿæˆç»“æœ URL æœ‰æ•ˆæœŸ 10 åˆ†é’Ÿï¼Œéœ€åŠæ—¶ä¸‹è½½
- **ğŸ”„ å¯é‡ç°æ€§**ï¼šæ”¯æŒ seed å‚æ•°ï¼Œç¡®ä¿ç»“æœä¸€è‡´æ€§

## ğŸ“‹ æ¨¡å‹å¯¹æ¯”

| æ¨¡å‹ | æ¨¡å‹ ID | è€å¼ API ä»·æ ¼ | å®˜æ–¹ä»·æ ¼ | èŠ‚çœæ¯”ä¾‹ | ç‰¹ç‚¹ |
|------|---------|-----------|----------|----------|------|
| **Flux Kontext Pro** | `flux-kontext-pro` | $0.035/æ¬¡ | $0.040/å¼  | 12.5% | é«˜æ€§ä»·æ¯”ï¼Œé€‚åˆæ‰¹é‡ä½¿ç”¨ |
| **Flux Kontext Max** | `flux-kontext-max` | $0.07/æ¬¡ | $0.08/å¼  | 12.5% | æœ€é«˜è´¨é‡ï¼Œé€‚åˆä¸“ä¸šç”¨é€” |

<Tip>
ğŸ’¡ **ä»·æ ¼ä¼˜åŠ¿**ï¼šé€šè¿‡ è€å¼ API å¹³å°è°ƒç”¨ Flux æ¨¡å‹ï¼Œç»“åˆæ±‡ç‡ä¼˜åŠ¿ï¼ˆ1:7ï¼‰å’Œå……å€¼åŠ èµ æ”¿ç­–ï¼ˆå•æ¬¡å……å€¼ 100 ç¾é‡‘åŠ èµ  10%ï¼Œæ¯”å®˜æ–¹å®šä»·èŠ‚çœè¶…è¿‡ 25%ï¼
</Tip>

## ğŸ“ æ”¯æŒçš„å®½é«˜æ¯”

Flux æ¨¡å‹æ”¯æŒä» **3:7 åˆ° 7:3** çš„è¿ç»­å®½é«˜æ¯”èŒƒå›´ï¼Œæ€»åƒç´ ä¿æŒçº¦ 1 å…†åƒç´ ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨æ¯”ä¾‹ç¤ºä¾‹ï¼š

| æ¯”ä¾‹æ ‡è¯† | ç±»å‹ | è¿‘ä¼¼å°ºå¯¸ | é€‚ç”¨åœºæ™¯ |
|---------|------|----------|----------|
| `1:1` | æ­£æ–¹å½¢ | 1024Ã—1024 | é€šç”¨åœºæ™¯ã€ç¤¾äº¤åª’ä½“å¤´åƒ |
| `2:3` | ç«–ç‰ˆ | ~832Ã—1248 | æ‰‹æœºå£çº¸ã€è‚–åƒç…§ç‰‡ |
| `3:2` | æ¨ªç‰ˆ | ~1248Ã—832 | ç”µè„‘å£çº¸ã€é£æ™¯ç…§ç‰‡ |
| `4:3` | æ ‡å‡†æ¨ªç‰ˆ | ~1182Ã—886 | ä¼ ç»Ÿæ˜¾ç¤ºå™¨ã€æ¼”ç¤ºæ–‡ç¨¿ |
| `16:9` | å®½å± | ~1408Ã—792 | ç°ä»£æ˜¾ç¤ºå™¨ã€è§†é¢‘ç¼©ç•¥å›¾ |
| `9:16` | ç«–å± | ~792Ã—1408 | æ‰‹æœºè§†é¢‘ã€ç«–ç‰ˆæµ·æŠ¥ |
| `21:9` | è¶…å®½å± | ~1680Ã—720 | ç”µå½±æµ·æŠ¥ã€è¶…å®½æ˜¾ç¤ºå™¨ |
| `3:7` | æœ€çª„ç«–ç‰ˆ | ~662Ã—1544 | ä¹¦ç­¾ã€ç«–ç‰ˆé•¿å›¾ |
| `7:3` | æœ€å®½æ¨ªç‰ˆ | ~1544Ã—662 | ç½‘ç«™æ¨ªå¹…ã€å…¨æ™¯å›¾ |

<Note>
**ğŸ“ è‡ªå®šä¹‰æ¯”ä¾‹**ï¼šé™¤äº†ä¸Šè¿°ç¤ºä¾‹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»»ä½•åœ¨ 3:7 åˆ° 7:3 èŒƒå›´å†…çš„æ¯”ä¾‹ï¼Œå¦‚ `5:4`ã€`4:5`ã€`16:10` ç­‰ã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒæ•´å°ºå¯¸ä»¥ä¿æŒçº¦ 1 å…†åƒç´ çš„æ€»é¢ç§¯ã€‚
</Note>

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åŸºç¡€ç¤ºä¾‹

```python
from openai import OpenAI

# åˆå§‹åŒ–å®¢æˆ·ç«¯
client = OpenAI(
    api_key="YOUR_API_KEY",
    base_url="https://api.laozhang.ai/v1"
)

# ç”Ÿæˆå›¾åƒï¼ˆå®Œæ•´å‚æ•°ç‰ˆï¼‰
def generate_flux_image(prompt, aspect_ratio="1:1", model="flux-kontext-pro",
                       seed=None, safety_tolerance=2, output_format="jpeg",
                       prompt_upsampling=False):
    """
    ç”Ÿæˆ Flux å›¾åƒ
    
    å‚æ•°ï¼š
    - prompt: å›¾åƒæè¿°æ–‡æœ¬
    - aspect_ratio: å®½é«˜æ¯” (3:7 åˆ° 7:3)
    - model: æ¨¡å‹é€‰æ‹©
    - seed: éšæœºç§å­ï¼Œç”¨äºç»“æœé‡ç°
    - safety_tolerance: å†…å®¹å®‰å…¨çº§åˆ« (0-6)
    - output_format: è¾“å‡ºæ ¼å¼ "jpeg" æˆ– "png"
    - prompt_upsampling: æ˜¯å¦å¢å¼ºæç¤ºè¯
    """
    try:
        # æ„å»º extra_body å‚æ•°
        extra_params = {
            "aspect_ratio": aspect_ratio,
            "safety_tolerance": safety_tolerance,
            "output_format": output_format,
            "prompt_upsampling": prompt_upsampling
        }
        
        # å¯é€‰å‚æ•°
        if seed is not None:
            extra_params["seed"] = seed
        
        response = client.images.generate(
            model=model,
            prompt=prompt,
            extra_body=extra_params
        )
        
        # è·å–å›¾åƒ URLï¼ˆæ³¨æ„ï¼š10åˆ†é’Ÿåå¤±æ•ˆï¼‰
        image_url = response.data[0].url
        return image_url
    
    except Exception as e:
        print(f"ç”Ÿæˆå¤±è´¥: {e}")
        return None

# ä½¿ç”¨ç¤ºä¾‹
image_url = generate_flux_image(
    prompt="A futuristic city with flying cars and neon lights",
    aspect_ratio="16:9",
    model="flux-kontext-pro",
    seed=42,  # å›ºå®šç§å­ï¼Œç¡®ä¿å¯é‡ç°
    safety_tolerance=2,  # é»˜è®¤å®‰å…¨çº§åˆ«
    output_format="png",  # é«˜è´¨é‡ PNG æ ¼å¼
    prompt_upsampling=True  # å¢å¼ºæç¤ºè¯æ•ˆæœ
)

if image_url:
    print(f"ç”Ÿæˆçš„å›¾åƒ: {image_url}")
    print("âš ï¸ æ³¨æ„ï¼šURL å°†åœ¨ 10 åˆ†é’Ÿåå¤±æ•ˆï¼Œè¯·åŠæ—¶ä¸‹è½½ï¼")
```

## ğŸ“ å‚æ•°è¯¦è§£

### é€šè¿‡ extra_body ä¼ é€’çš„å‚æ•°

| å‚æ•° | ç±»å‹ | èŒƒå›´/é€‰é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|-----------|------|--------|
| `aspect_ratio` | string | 3:7 åˆ° 7:3 | è¾“å‡ºå›¾åƒå®½é«˜æ¯” | "1:1" |
| `seed` | integer | ä»»æ„æ•´æ•° | éšæœºç§å­ï¼Œç”¨äºç»“æœé‡ç° | éšæœº |
| `safety_tolerance` | integer | 0-6 | å†…å®¹å®‰å…¨æ§åˆ¶ï¼Œ0=æœ€ä¸¥æ ¼ï¼Œ6=æœ€å®½æ¾ | 2 |
| `output_format` | string | "jpeg", "png" | è¾“å‡ºå›¾åƒæ ¼å¼ | "jpeg" |
| `prompt_upsampling` | boolean | true/false | æ˜¯å¦è‡ªåŠ¨å¢å¼ºæç¤ºè¯ | false |

<Tip>
**ğŸ’¡ æç¤ºè¯å¢å¼º**ï¼šå¯ç”¨ `prompt_upsampling` å¯ä»¥è®© AI è‡ªåŠ¨ä¼˜åŒ–å’Œæ‰©å±•æ‚¨çš„æç¤ºè¯ï¼Œä½†å¯èƒ½ä¼šæ”¹å˜åŸå§‹æ„å›¾ã€‚å»ºè®®å…ˆæµ‹è¯•æ•ˆæœã€‚
</Tip>

### é«˜çº§ç¤ºä¾‹ - æ‰¹é‡ç”Ÿæˆä¸åŒæ¯”ä¾‹

```python
import requests
import time
from PIL import Image
from io import BytesIO

def batch_generate_flux(prompts_with_ratios, model="flux-kontext-pro"):
    """æ‰¹é‡ç”Ÿæˆä¸åŒæ¯”ä¾‹çš„å›¾åƒ"""
    results = []
    
    for prompt, ratio in prompts_with_ratios:
        try:
            print(f"æ­£åœ¨ç”Ÿæˆ {ratio} æ¯”ä¾‹çš„å›¾åƒ...")
            
            response = client.images.generate(
                model=model,
                prompt=prompt,
                extra_body={"aspect_ratio": ratio}
            )
            
            image_url = response.data[0].url
            
            # ä¸‹è½½å¹¶ä¿å­˜å›¾åƒ
            filename = save_image_from_url(image_url, prompt, ratio)
            
            results.append({
                "prompt": prompt,
                "ratio": ratio,
                "url": image_url,
                "filename": filename,
                "success": True
            })
            
        except Exception as e:
            results.append({
                "prompt": prompt,
                "ratio": ratio,
                "error": str(e),
                "success": False
            })
    
    return results

def save_image_from_url(url, prompt, ratio):
    """ä» URL ä¸‹è½½å¹¶ä¿å­˜å›¾åƒï¼ˆè€ƒè™‘ 10 åˆ†é’Ÿå¤±æ•ˆï¼‰"""
    try:
        # ç«‹å³ä¸‹è½½ï¼Œé¿å… URL å¤±æ•ˆ
        response = requests.get(url, timeout=30)
        response.raise_for_status()
        
        # ç”Ÿæˆæ–‡ä»¶å
        timestamp = int(time.time())
        safe_prompt = prompt[:30].replace(" ", "_").replace("/", "_")
        filename = f"flux_{safe_prompt}_{ratio.replace(':', 'x')}_{timestamp}.png"
        
        with open(filename, 'wb') as f:
            f.write(response.content)
        
        print(f"âœ… å·²ä¿å­˜: {filename}")
        return filename
        
    except requests.exceptions.RequestException as e:
        print(f"âŒ ä¸‹è½½å¤±è´¥: {e}")
        print("æç¤ºï¼šFlux URL ä»… 10 åˆ†é’Ÿæœ‰æ•ˆï¼Œè¯·ç¡®ä¿åŠæ—¶ä¸‹è½½ï¼")
        return None

# æ‰¹é‡ç”Ÿæˆç¤ºä¾‹
prompts_and_ratios = [
    ("A beautiful sunset over mountains", "3:2"),
    ("Portrait of a wise old wizard", "2:3"),
    ("Cyberpunk street scene", "16:9"),
    ("Minimalist app icon design", "1:1")
]

results = batch_generate_flux(prompts_and_ratios, "flux-kontext-max")

# æ‰“å°ç»“æœ
for result in results:
    if result["success"]:
        print(f"âœ… {result['prompt']} ({result['ratio']}) -> {result['filename']}")
    else:
        print(f"âŒ {result['prompt']} ({result['ratio']}) -> {result['error']}")
```

### Node.js ç¤ºä¾‹

```javascript
const OpenAI = require('openai');
const fs = require('fs');
const https = require('https');

// åˆå§‹åŒ–å®¢æˆ·ç«¯
const openai = new OpenAI({
  apiKey: 'YOUR_API_KEY',
  baseURL: 'https://api.laozhang.ai/v1'
});

// ç”Ÿæˆ Flux å›¾åƒ
async function generateFluxImage(prompt, aspectRatio = '1:1', model = 'flux-kontext-pro') {
  try {
    const response = await openai.images.generate({
      model: model,
      prompt: prompt,
      extra_body: {
        aspect_ratio: aspectRatio
      }
    });
    
    return response.data[0].url;
  } catch (error) {
    console.error('ç”Ÿæˆå¤±è´¥:', error);
    return null;
  }
}

// ä¸‹è½½å›¾åƒ
function downloadImage(url, filename) {
  return new Promise((resolve, reject) => {
    const file = fs.createWriteStream(filename);
    https.get(url, (response) => {
      response.pipe(file);
      file.on('finish', () => {
        file.close();
        resolve(filename);
      });
    }).on('error', (err) => {
      fs.unlink(filename, () => {}); // åˆ é™¤å¤±è´¥çš„æ–‡ä»¶
      reject(err);
    });
  });
}

// ä½¿ç”¨ç¤ºä¾‹
async function main() {
  const scenarios = [
    {
      prompt: "A serene Japanese garden with cherry blossoms",
      ratio: "3:2",
      model: "flux-kontext-pro"
    },
    {
      prompt: "Abstract geometric pattern in vibrant colors",
      ratio: "1:1", 
      model: "flux-kontext-max"
    }
  ];
  
  for (const scenario of scenarios) {
    console.log(`ç”Ÿæˆå›¾åƒ: ${scenario.prompt}`);
    
    const imageUrl = await generateFluxImage(
      scenario.prompt,
      scenario.ratio,
      scenario.model
    );
    
    if (imageUrl) {
      const filename = `flux_${Date.now()}.png`;
      await downloadImage(imageUrl, filename);
      console.log(`å·²ä¿å­˜: ${filename}`);
    }
  }
}

main().catch(console.error);
```

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### 1. Web è®¾è®¡ç´ æ

```python
# ç½‘ç«™æ¨ªå¹…
banner = generate_flux_image(
    "Modern website banner with clean design and tech elements",
    aspect_ratio="7:3",
    model="flux-kontext-max"
)

# äº§å“å±•ç¤ºå›¾
product = generate_flux_image(
    "Elegant product photography of a smartphone on white background",
    aspect_ratio="1:1",
    model="flux-kontext-pro"
)
```

### 2. ç¤¾äº¤åª’ä½“å†…å®¹

```python
# Instagram å¸–å­
instagram_post = generate_flux_image(
    "Inspirational quote design with aesthetic background",
    aspect_ratio="1:1",
    model="flux-kontext-pro"
)

# æ‰‹æœºå£çº¸
mobile_wallpaper = generate_flux_image(
    "Abstract cosmic art with stars and nebula",
    aspect_ratio="9:16",
    model="flux-kontext-max"
)
```

### 3. ä¸“ä¸šè®¾è®¡

```python
# æµ·æŠ¥è®¾è®¡
poster = generate_flux_image(
    "Concert poster design with bold typography and music elements",
    aspect_ratio="2:3",
    model="flux-kontext-max"
)

# ç½‘ç«™èƒŒæ™¯
background = generate_flux_image(
    "Subtle geometric pattern for website background",
    aspect_ratio="16:9",
    model="flux-kontext-pro"
)
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. URL ç®¡ç†å’Œä¸‹è½½ç­–ç•¥

ç”±äº Flux ç”Ÿæˆçš„å›¾ç‰‡ URL **ä»…æœ‰ 10 åˆ†é’Ÿæœ‰æ•ˆæœŸ**ï¼Œæ­£ç¡®çš„ä¸‹è½½ç­–ç•¥è‡³å…³é‡è¦ï¼š

```python
import time
from concurrent.futures import ThreadPoolExecutor
import requests

class FluxImageManager:
    """Flux å›¾åƒç”Ÿæˆå’Œä¸‹è½½ç®¡ç†å™¨"""
    
    def __init__(self, api_key, base_url="https://api.laozhang.ai/v1"):
        self.client = OpenAI(api_key=api_key, base_url=base_url)
        
    def generate_and_save(self, prompt, **kwargs):
        """ç”Ÿæˆå›¾åƒå¹¶ç«‹å³ä¿å­˜"""
        start_time = time.time()
        
        # ç”Ÿæˆå›¾åƒ
        image_url = generate_flux_image(prompt, **kwargs)
        if not image_url:
            return None
            
        # ç«‹å³ä¸‹è½½ï¼ˆé¿å…è¶…æ—¶ï¼‰
        elapsed = time.time() - start_time
        if elapsed > 540:  # è¶…è¿‡ 9 åˆ†é’Ÿ
            print("âš ï¸ è­¦å‘Šï¼šæ¥è¿‘ URL å¤±æ•ˆæ—¶é—´ï¼")
        
        # ä¸‹è½½å¹¶ä¿å­˜
        filename = f"flux_{int(time.time())}.png"
        try:
            response = requests.get(image_url, timeout=30)
            response.raise_for_status()
            
            with open(filename, 'wb') as f:
                f.write(response.content)
                
            print(f"âœ… å·²ä¿å­˜: {filename} (è€—æ—¶: {elapsed:.1f}s)")
            return filename
            
        except Exception as e:
            print(f"âŒ ä¸‹è½½å¤±è´¥: {e}")
            return None
```

### 2. æ¨¡å‹é€‰æ‹©å»ºè®®

**Flux Kontext Pro**ï¼š
- âœ… æ—¥å¸¸è®¾è®¡éœ€æ±‚
- âœ… æ‰¹é‡å†…å®¹ç”Ÿæˆ
- âœ… æˆæœ¬æ•æ„Ÿé¡¹ç›®
- âœ… å¿«é€ŸåŸå‹è®¾è®¡

**Flux Kontext Max**ï¼š
- âœ… ä¸“ä¸šè®¾è®¡ä½œå“
- âœ… å•†ä¸šç”¨é€”å›¾ç‰‡
- âœ… é«˜è´¨é‡è¦æ±‚
- âœ… æ‰“å°è¾“å‡ºéœ€æ±‚

### 3. æç¤ºè¯ä¼˜åŒ–

åŸºäºå®˜æ–¹æ–‡æ¡£çš„å»ºè®®ï¼Œè¯¦ç»†ä¸”æè¿°æ€§çš„æç¤ºè¯èƒ½è·å¾—æ›´å¥½çš„æ•ˆæœï¼š

```python
# âŒ è¿‡äºç®€å•
prompt = "cat"

# âœ… è¯¦ç»†æè¿°
prompt = """
A majestic orange tabby cat sitting by a window,
golden hour lighting, soft focus background,
professional pet photography style,
warm and cozy atmosphere
"""

# âœ… åˆ©ç”¨ prompt_upsampling å¢å¼ºç®€å•æç¤ºè¯
enhanced_result = generate_flux_image(
    prompt="cat by window",
    prompt_upsampling=True  # AI ä¼šè‡ªåŠ¨æ‰©å±•å’Œä¼˜åŒ–æç¤ºè¯
)

# âœ… è‰ºæœ¯é£æ ¼æç¤ºè¯
artistic_prompt = """
A surreal landscape painting in the style of Salvador Dali,
melting clocks draped over twisted trees,
vibrant sunset colors bleeding into a starry night sky,
hyper-detailed, dreamlike atmosphere
"""
```

### 4. å®½é«˜æ¯”é€‰æ‹©ç­–ç•¥

```python
def choose_aspect_ratio(use_case):
    """æ ¹æ®ç”¨é€”é€‰æ‹©æœ€ä½³å®½é«˜æ¯”"""
    ratios = {
        "social_media_post": "1:1",
        "mobile_wallpaper": "9:16", 
        "desktop_wallpaper": "16:9",
        "portrait_photo": "2:3",
        "landscape_photo": "3:2",
        "website_banner": "7:3",
        "bookmark_design": "3:7"
    }
    return ratios.get(use_case, "1:1")

# ä½¿ç”¨ç¤ºä¾‹
ratio = choose_aspect_ratio("mobile_wallpaper")
wallpaper = generate_flux_image("Peaceful forest scene", ratio)
```

### 5. æ‰¹é‡å¤„ç†ä¼˜åŒ–

è€ƒè™‘åˆ° 10 åˆ†é’Ÿ URL å¤±æ•ˆé™åˆ¶ï¼Œæ‰¹é‡å¤„ç†éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š

```python
import asyncio
import aiohttp

async def generate_async(session, prompt, ratio, model):
    """å¼‚æ­¥ç”Ÿæˆå›¾åƒ"""
    payload = {
        "model": model,
        "prompt": prompt,
        "extra_body": {"aspect_ratio": ratio}
    }
    
    headers = {
        "Authorization": f"Bearer {API_KEY}",
        "Content-Type": "application/json"
    }
    
    async with session.post(
        "https://api.laozhang.ai/v1/images/generations",
        json=payload,
        headers=headers
    ) as response:
        result = await response.json()
        return result["data"][0]["url"]

async def batch_generate_async(tasks):
    """å¼‚æ­¥æ‰¹é‡ç”Ÿæˆ"""
    async with aiohttp.ClientSession() as session:
        results = await asyncio.gather(*[
            generate_async(session, prompt, ratio, model)
            for prompt, ratio, model in tasks
        ])
    return results
```

## ğŸ“Š æˆæœ¬å¯¹æ¯”åˆ†æ

```python
def calculate_flux_costs(num_images, model_type="pro"):
    """è®¡ç®— Flux ç”Ÿæˆæˆæœ¬"""
    prices = {
        "pro": {"laozhang": 0.035, "official": 0.040},
        "max": {"laozhang": 0.07, "official": 0.08}
    }
    
    laozhang_cost = num_images * prices[model_type]["laozhang"]
    official_cost = num_images * prices[model_type]["official"]
    savings = official_cost - laozhang_cost
    
    print(f"Flux Kontext {model_type.upper()} æˆæœ¬åˆ†æ:")
    print(f"ç”Ÿæˆæ•°é‡: {num_images} å¼ ")
    print(f"è€å¼ APIä»·æ ¼: ${laozhang_cost:.2f}")
    print(f"å®˜æ–¹ä»·æ ¼: ${official_cost:.2f}")
    print(f"èŠ‚çœé‡‘é¢: ${savings:.2f}")
    print(f"èŠ‚çœæ¯”ä¾‹: {(savings/official_cost*100):.1f}%")

# æˆæœ¬è®¡ç®—ç¤ºä¾‹
calculate_flux_costs(100, "pro")   # 100å¼  Pro ç‰ˆæœ¬
calculate_flux_costs(50, "max")    # 50å¼  Max ç‰ˆæœ¬
```

## âš ï¸ é‡è¦æ³¨æ„äº‹é¡¹

1. **URL æœ‰æ•ˆæœŸ**ï¼š
   - ç”Ÿæˆçš„å›¾ç‰‡ URL **ä»… 10 åˆ†é’Ÿæœ‰æ•ˆ**
   - å¿…é¡»åœ¨å¤±æ•ˆå‰å®Œæˆä¸‹è½½
   - å»ºè®®ç”Ÿæˆåç«‹å³ä¸‹è½½ä¿å­˜

2. **å‚æ•°ä¼ é€’**ï¼š
   - æ‰€æœ‰ Flux ç‰¹æœ‰å‚æ•°å¿…é¡»é€šè¿‡ `extra_body` ä¼ é€’
   - ä¸èƒ½åœ¨é¡¶å±‚å‚æ•°ä¸­ç›´æ¥ä½¿ç”¨ Flux ä¸“æœ‰å‚æ•°

3. **å®½é«˜æ¯”èŒƒå›´**ï¼š
   - æ”¯æŒ 3:7 åˆ° 7:3 çš„è¿ç»­èŒƒå›´
   - ä¸é™äºå›ºå®šæ¯”ä¾‹ï¼Œå¯ä½¿ç”¨ä»»æ„ç¬¦åˆèŒƒå›´çš„æ¯”ä¾‹
   - ç³»ç»Ÿè‡ªåŠ¨è°ƒæ•´å°ºå¯¸ä»¥ä¿æŒçº¦ 1 å…†åƒç´ 

4. **å†…å®¹å®‰å…¨**ï¼š
   - `safety_tolerance` å‚æ•°æ§åˆ¶å®¡æ ¸ä¸¥æ ¼åº¦ (0-6)
   - 0 = æœ€ä¸¥æ ¼ï¼Œ6 = æœ€å®½æ¾
   - é»˜è®¤å€¼ 2 é€‚åˆå¤§å¤šæ•°åœºæ™¯

5. **è¾“å‡ºæ ¼å¼**ï¼š
   - é»˜è®¤ JPEG æ ¼å¼ï¼Œæ–‡ä»¶è¾ƒå°
   - PNG æ ¼å¼è´¨é‡æ›´é«˜ä½†æ–‡ä»¶æ›´å¤§
   - æ ¹æ®ç”¨é€”é€‰æ‹©åˆé€‚æ ¼å¼

6. **æç¤ºè¯å¤„ç†**ï¼š
   - `prompt_upsampling` ä¼šè‡ªåŠ¨ä¼˜åŒ–æç¤ºè¯
   - å¯èƒ½ä¼šæ”¹å˜åŸå§‹æ„å›¾ï¼Œå»ºè®®å…ˆæµ‹è¯•
   - å¯¹ç®€å•æç¤ºè¯æ•ˆæœæ˜æ˜¾

## ğŸ” å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆå›¾ç‰‡ URL ä¼šå¤±æ•ˆï¼Ÿ
A: è¿™æ˜¯ Flux å®˜æ–¹çš„å®‰å…¨è®¾è®¡ï¼Œæ‰€æœ‰ç”Ÿæˆçš„å›¾ç‰‡ URL åœ¨ 10 åˆ†é’Ÿåè‡ªåŠ¨å¤±æ•ˆã€‚è¯·ç¡®ä¿åŠæ—¶ä¸‹è½½ä¿å­˜ã€‚

### Q: Flux ä¸å…¶ä»–æ¨¡å‹æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ
A: Flux æ¨¡å‹ä¸“æ³¨äºé«˜è´¨é‡å›¾åƒç”Ÿæˆï¼Œæ”¯æŒçµæ´»çš„å®½é«˜æ¯”ï¼ˆ3:7 åˆ° 7:3ï¼‰ï¼Œç‰¹åˆ«é€‚åˆéœ€è¦ç‰¹å®šå°ºå¯¸çš„ä¸“ä¸šè®¾è®¡ã€‚

### Q: å¦‚ä½•é€‰æ‹© Pro å’Œ Max ç‰ˆæœ¬ï¼Ÿ
A: 
- **Pro**ï¼šæ€§ä»·æ¯”é«˜ï¼Œ$0.035/å¼ ï¼Œé€‚åˆæ—¥å¸¸ä½¿ç”¨å’Œæ‰¹é‡ç”Ÿæˆ
- **Max**ï¼šæœ€é«˜è´¨é‡ï¼Œ$0.07/å¼ ï¼Œé€‚åˆå•†ä¸šä½œå“å’Œä¸“ä¸šéœ€æ±‚

### Q: å¯ä»¥ä½¿ç”¨ä»»æ„å®½é«˜æ¯”å—ï¼Ÿ
A: å¯ä»¥ä½¿ç”¨ 3:7 åˆ° 7:3 èŒƒå›´å†…çš„ä»»æ„æ¯”ä¾‹ï¼Œå¦‚ `5:4`ã€`16:10`ã€`21:9` ç­‰ã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨è°ƒæ•´ä»¥ä¿æŒçº¦ 1 å…†åƒç´ ã€‚

### Q: safety_tolerance å¦‚ä½•è®¾ç½®ï¼Ÿ
A: 
- 0-1ï¼šä¼ä¸š/å•†ä¸šç¯å¢ƒï¼Œæœ€ä¸¥æ ¼
- 2-3ï¼šä¸€èˆ¬åˆ›ä½œï¼Œå¹³è¡¡æ¨¡å¼ï¼ˆæ¨èï¼‰
- 4-6ï¼šè‰ºæœ¯åˆ›ä½œï¼Œè¾ƒå®½æ¾

### Q: prompt_upsampling æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ
A: å¯ç”¨å AI ä¼šè‡ªåŠ¨æ‰©å±•å’Œä¼˜åŒ–æ‚¨çš„æç¤ºè¯ï¼Œç‰¹åˆ«é€‚åˆç®€çŸ­æç¤ºè¯ã€‚ä½†å¯èƒ½ä¼šæ”¹å˜åŸæ„ï¼Œå»ºè®®å…ˆæµ‹è¯•æ•ˆæœã€‚

### Q: å¦‚ä½•ç¡®ä¿ç»“æœå¯é‡ç°ï¼Ÿ
A: ä½¿ç”¨ç›¸åŒçš„ `seed` å€¼å’Œå®Œå…¨ç›¸åŒçš„å…¶ä»–å‚æ•°ï¼Œå¯ä»¥ç”Ÿæˆä¸€è‡´çš„ç»“æœã€‚è¿™å¯¹è¿­ä»£è®¾è®¡å¾ˆæœ‰å¸®åŠ©ã€‚

### Q: æ‰¹é‡ç”Ÿæˆå¦‚ä½•é¿å… URL å¤±æ•ˆï¼Ÿ
A: 
1. ç”Ÿæˆåç«‹å³ä¸‹è½½
2. ä½¿ç”¨å¹¶å‘æ§åˆ¶ï¼Œé¿å…å¤„ç†æ—¶é—´è¿‡é•¿
3. è€ƒè™‘ä½¿ç”¨å¼‚æ­¥å¤„ç†æé«˜æ•ˆç‡

## ğŸ¯ å¤šå›¾å¤„ç†è§£å†³æ–¹æ¡ˆ

Flux API åŸç”Ÿåªæ”¯æŒå•å¼ å›¾ç‰‡è¾“å…¥ï¼Œä½†é€šè¿‡æˆ‘ä»¬æä¾›çš„æ‰¹é‡å¤„ç†è„šæœ¬ï¼Œå¯ä»¥å®ç°**åŒå›¾ç‰‡åˆæˆå¤„ç†**ã€‚

### åº”ç”¨åœºæ™¯

- **å›¾æ¡ˆè½¬ç§»**ï¼šå°†è®¾è®¡å›¾æ¡ˆè½¬ç§»åˆ°æœè£…æ¨¡ç‰¹ä¸Š
- **é£æ ¼èåˆ**ï¼šç»“åˆä¸¤å¼ å›¾çš„ç‰¹è‰²å…ƒç´ 
- **å¯¹æ¯”å±•ç¤º**ï¼šåŒæ—¶å±•ç¤ºåŸå›¾å’Œç›®æ ‡æ•ˆæœ

### æŠ€æœ¯åŸç†

<AccordionGroup>
  <Accordion icon="merge" title="å›¾ç‰‡åˆå¹¶ç­–ç•¥">
    1. **è‡ªåŠ¨ä¸‹è½½**ï¼šä» URL è·å–ä¸¤å¼ è¾“å…¥å›¾ç‰‡
    2. **æ™ºèƒ½åˆå¹¶**ï¼šä½¿ç”¨ Python PIL å°†å›¾ç‰‡å·¦å³æ‹¼æ¥
    3. **API è°ƒç”¨**ï¼šå°†åˆå¹¶åçš„å›¾ç‰‡ä½œä¸ºå•ä¸€è¾“å…¥
    4. **ç»“æœå¤„ç†**ï¼šAI åŸºäºåˆå¹¶å›¾è¿›è¡Œæ™ºèƒ½å¤„ç†
  </Accordion>
  
  <Accordion icon="code" title="æ‰¹é‡å¤„ç†èƒ½åŠ›">
    - æ”¯æŒå¤šå¯¹å›¾ç‰‡çš„è‡ªåŠ¨åŒ–å¤„ç†
    - ç»Ÿä¸€çš„æç¤ºè¯æ§åˆ¶å¤„ç†æ•ˆæœ
    - è‡ªåŠ¨ç»“æœä¸‹è½½å’Œæ–‡ä»¶ç®¡ç†
    - å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
  </Accordion>
</AccordionGroup>

### å¿«é€Ÿå¼€å§‹

<CodeGroup>

```bash Shellè„šæœ¬
# ä¸‹è½½æ‰¹é‡å¤„ç†è„šæœ¬
wget https://raw.githubusercontent.com/laozhang-api/ai-api-code-samples/main/flux-Image-API/flux-simple-batch.sh
chmod +x flux-simple-batch.sh

# ä¿®æ”¹é…ç½®
# 1. è®¾ç½®æ‚¨çš„ API_KEY
# 2. é…ç½®å›¾ç‰‡å¯¹æ•°ç»„
# 3. è‡ªå®šä¹‰å¤„ç†æç¤ºè¯

# è¿è¡Œæ‰¹é‡å¤„ç†
./flux-simple-batch.sh
```

```python Pythonå®ç°
import requests
from PIL import Image
import io

def merge_and_process(ref_url, base_url, prompt):
    """åˆå¹¶ä¸¤å¼ å›¾ç‰‡å¹¶è°ƒç”¨Fluxå¤„ç†"""
    
    # ä¸‹è½½å›¾ç‰‡
    ref_img = Image.open(io.BytesIO(requests.get(ref_url).content))
    base_img = Image.open(io.BytesIO(requests.get(base_url).content))
    
    # ç»Ÿä¸€é«˜åº¦å¹¶å·¦å³åˆå¹¶
    height = min(ref_img.height, base_img.height)
    ref_resized = ref_img.resize((int(ref_img.width * height / ref_img.height), height))
    base_resized = base_img.resize((int(base_img.width * height / base_img.height), height))
    
    merged = Image.new('RGB', (ref_resized.width + base_resized.width, height))
    merged.paste(ref_resized, (0, 0))
    merged.paste(base_resized, (ref_resized.width, 0))
    
    # ä¿å­˜ä¸ºä¸´æ—¶æ–‡ä»¶
    merged.save('temp_merged.jpg')
    
    # è°ƒç”¨Flux API
    with open('temp_merged.jpg', 'rb') as f:
        response = requests.post(
            'https://api.laozhang.ai/v1/images/edits',
            headers={'Authorization': f'Bearer {API_KEY}'},
            files={'image': f},
            data={
                'model': 'flux-kontext-max',
                'prompt': prompt,
                'n': 1,
                'size': '1024x1024'
            }
        )
    
    return response.json()['data'][0]['url']
```

</CodeGroup>

### é…ç½®ç¤ºä¾‹

```bash
# æç¤ºè¯é…ç½®
BATCH_PROMPT="Look at the left image and right image. Transfer the pattern/design from the left image to the clothes of the model in the right image, with the size being 2/3 of the width of the chest, located in the middle. Make it look natural and well-integrated."

# å›¾ç‰‡å¯¹æ•°ç»„
IMAGE_PAIRS=(
    "https://example.com/pattern1.jpg|https://example.com/model1.jpg"
    "https://example.com/design2.jpg|https://example.com/shirt2.jpg"
)
```

<Warning>
**ä¾èµ–è¦æ±‚**ï¼šè„šæœ¬éœ€è¦ `jq`ã€`Python3 + PIL` å’Œå¯é€‰çš„ `ImageMagick`ã€‚è¯¦ç»†å®‰è£…è¯´æ˜è¯·å‚è€ƒè„šæœ¬å¸®åŠ©ã€‚
</Warning>

## ğŸ”— ç›¸å…³èµ„æº

- [å®Œæ•´ç¤ºä¾‹ä»£ç ](https://github.com/laozhang-api/ai-api-code-samples/tree/main/flux-Image-API)
- [å¤šå›¾å¤„ç†è„šæœ¬](https://github.com/laozhang-api/ai-api-code-samples/blob/main/flux-Image-API/flux-simple-batch.sh)
- [Flux å›¾åƒç¼–è¾‘ API](/api-capabilities/flux-image-edit) - ç¼–è¾‘ç°æœ‰å›¾ç‰‡
- [ä»·æ ¼å¯¹æ¯”è®¡ç®—å™¨](https://api.laozhang.ai/account/pricing) - å®æ—¶ä»·æ ¼æŸ¥è¯¢
- [åœ¨çº¿ä½“éªŒ Demo](https://imagen.laozhang.ai) - æµ‹è¯• Flux æ•ˆæœ

<Note>
ğŸ¨ **ä¸“ä¸šæç¤º**ï¼šç»“åˆä¸åŒå®½é«˜æ¯”å’Œæ¨¡å‹ç‰ˆæœ¬ï¼Œå¯ä»¥æ»¡è¶³ä»ç¤¾äº¤åª’ä½“åˆ°ä¸“ä¸šè®¾è®¡çš„å„ç§éœ€æ±‚ï¼
</Note>